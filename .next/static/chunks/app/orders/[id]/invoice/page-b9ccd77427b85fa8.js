(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5228],{7921:(e,s,a)=>{Promise.resolve().then(a.bind(a,6889))},6889:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>o});var t=a(5155),i=a(8803),r=a.n(i),l=a(2115),n=a(6046),c=a(2615),d=a(9663),x=a(7908);let f=e=>{if(!e)return"—";try{let s=new Date(e);if(isNaN(s.getTime()))return"—";return s.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch(e){return"—"}};function o(){var e,s,a;let i=(0,n.useParams)(),o=null==i?void 0:i.id,{data:m,status:j}=(0,c.useSession)(),[h,p]=(0,l.useState)(null),[u,N]=(0,l.useState)(!0),[g,b]=(0,l.useState)(null);return((0,l.useEffect)(()=>{if(o&&"loading"!==j){if(!m){N(!1),b("Please sign in to view invoice");return}(async()=>{try{N(!0),b(null);let e=await fetch("/api/orders/".concat(o),{credentials:"include",cache:"no-store"});if(!e.ok){if(404===e.status)throw Error("Order not found");if(401===e.status)throw Error("You do not have access to this invoice");throw Error("Unable to load invoice")}let s=await e.json(),a=s.success&&s.data?s.data:s;p(a)}catch(e){b(e.message)}finally{N(!1)}})()}},[o,m,j]),(0,l.useEffect)(()=>{h&&!u&&window.location.search.includes("download=true")&&setTimeout(()=>{window.print()},500)},[h,u]),"loading"===j||u)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-white",children:(0,t.jsx)(x.A,{size:"lg",color:"blue",text:"Loading invoice"})}):m&&!g&&h?(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef min-h-screen bg-white p-8 print:p-4",children:[(0,t.jsx)("div",{className:"jsx-ea7e30f1006202ef no-print max-w-4xl mx-auto mb-6 flex justify-end",children:(0,t.jsxs)("button",{onClick:()=>{window.print()},className:"jsx-ea7e30f1006202ef px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:from-blue-700 hover:to-indigo-700 transition-all font-bold shadow-lg hover:shadow-xl flex items-center gap-2",children:[(0,t.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-ea7e30f1006202ef w-5 h-5",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z",className:"jsx-ea7e30f1006202ef"})}),"Download as PDF"]})}),(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef max-w-4xl mx-auto",children:[(0,t.jsx)("div",{className:"jsx-ea7e30f1006202ef border-b-2 border-gray-900 pb-6 mb-8",children:(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef",children:[(0,t.jsx)("h1",{className:"jsx-ea7e30f1006202ef text-4xl font-black text-gray-900 mb-2",children:"INVOICE"}),(0,t.jsxs)("p",{className:"jsx-ea7e30f1006202ef text-gray-600",children:["Invoice #",h.orderNumber]}),(0,t.jsxs)("p",{className:"jsx-ea7e30f1006202ef text-gray-600",children:["Date: ",f(h.createdAt)]})]}),(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef text-right",children:[(0,t.jsx)("h2",{className:"jsx-ea7e30f1006202ef text-2xl font-bold text-gray-900 mb-2",children:"Dilitech Solutions"}),(0,t.jsx)("p",{className:"jsx-ea7e30f1006202ef text-sm text-gray-600",children:"600 California St, Suite 420"}),(0,t.jsx)("p",{className:"jsx-ea7e30f1006202ef text-sm text-gray-600",children:"San Francisco, CA 94108"}),(0,t.jsx)("p",{className:"jsx-ea7e30f1006202ef text-sm text-gray-600 mt-2",children:"support@dilitechsolutions.com"})]})]})}),(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef grid grid-cols-2 gap-8 mb-8",children:[(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef",children:[(0,t.jsx)("h3",{className:"jsx-ea7e30f1006202ef text-sm font-bold text-gray-500 uppercase tracking-wide mb-2",children:"Bill To"}),(0,t.jsx)("p",{className:"jsx-ea7e30f1006202ef font-semibold text-gray-900",children:(null===(e=h.user)||void 0===e?void 0:e.name)||"Customer"}),(0,t.jsx)("p",{className:"jsx-ea7e30f1006202ef text-gray-600",children:(null===(s=h.user)||void 0===s?void 0:s.email)||""}),h.shippingAddress&&(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef mt-2 text-sm text-gray-600",children:[(0,t.jsx)("p",{className:"jsx-ea7e30f1006202ef",children:h.shippingAddress.fullName||h.shippingAddress.street}),h.shippingAddress.street&&(0,t.jsx)("p",{className:"jsx-ea7e30f1006202ef",children:h.shippingAddress.street}),(0,t.jsxs)("p",{className:"jsx-ea7e30f1006202ef",children:[h.shippingAddress.city||"",h.shippingAddress.state?", ".concat(h.shippingAddress.state):"",h.shippingAddress.postalCode?" ".concat(h.shippingAddress.postalCode):""]}),h.shippingAddress.country&&(0,t.jsx)("p",{className:"jsx-ea7e30f1006202ef",children:h.shippingAddress.country})]})]}),(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef",children:[(0,t.jsx)("h3",{className:"jsx-ea7e30f1006202ef text-sm font-bold text-gray-500 uppercase tracking-wide mb-2",children:"Order Details"}),(0,t.jsxs)("p",{className:"jsx-ea7e30f1006202ef text-gray-600",children:[(0,t.jsx)("span",{className:"jsx-ea7e30f1006202ef font-semibold",children:"Order Number:"})," ",h.orderNumber]}),(0,t.jsxs)("p",{className:"jsx-ea7e30f1006202ef text-gray-600",children:[(0,t.jsx)("span",{className:"jsx-ea7e30f1006202ef font-semibold",children:"Status:"})," ",h.status]}),(0,t.jsxs)("p",{className:"jsx-ea7e30f1006202ef text-gray-600",children:[(0,t.jsx)("span",{className:"jsx-ea7e30f1006202ef font-semibold",children:"Payment:"})," ",h.paymentStatus]}),h.paymentMethod&&(0,t.jsxs)("p",{className:"jsx-ea7e30f1006202ef text-gray-600",children:[(0,t.jsx)("span",{className:"jsx-ea7e30f1006202ef font-semibold",children:"Method:"})," ",h.paymentMethod]}),h.mpesaReceiptNumber&&(0,t.jsxs)("p",{className:"jsx-ea7e30f1006202ef text-gray-600",children:[(0,t.jsx)("span",{className:"jsx-ea7e30f1006202ef font-semibold",children:"M-Pesa Receipt:"})," ",h.mpesaReceiptNumber]})]})]}),(0,t.jsx)("div",{className:"jsx-ea7e30f1006202ef mb-8",children:(0,t.jsxs)("table",{className:"jsx-ea7e30f1006202ef w-full border-collapse",children:[(0,t.jsx)("thead",{className:"jsx-ea7e30f1006202ef",children:(0,t.jsxs)("tr",{className:"jsx-ea7e30f1006202ef border-b-2 border-gray-900",children:[(0,t.jsx)("th",{className:"jsx-ea7e30f1006202ef text-left py-3 px-4 font-bold text-gray-900",children:"Item"}),(0,t.jsx)("th",{className:"jsx-ea7e30f1006202ef text-right py-3 px-4 font-bold text-gray-900",children:"Quantity"}),(0,t.jsx)("th",{className:"jsx-ea7e30f1006202ef text-right py-3 px-4 font-bold text-gray-900",children:"Unit Price"}),(0,t.jsx)("th",{className:"jsx-ea7e30f1006202ef text-right py-3 px-4 font-bold text-gray-900",children:"Total"})]})}),(0,t.jsx)("tbody",{className:"jsx-ea7e30f1006202ef",children:null===(a=h.items)||void 0===a?void 0:a.map((e,s)=>{var a,i;return(0,t.jsxs)("tr",{className:"jsx-ea7e30f1006202ef "+((s%2==0?"bg-gray-50":"bg-white")||""),children:[(0,t.jsxs)("td",{className:"jsx-ea7e30f1006202ef py-3 px-4",children:[(0,t.jsx)("p",{className:"jsx-ea7e30f1006202ef font-semibold text-gray-900",children:(null===(a=e.product)||void 0===a?void 0:a.name)||"Product removed"}),(null===(i=e.product)||void 0===i?void 0:i.sku)&&(0,t.jsxs)("p",{className:"jsx-ea7e30f1006202ef text-sm text-gray-500",children:["SKU: ",e.product.sku]})]}),(0,t.jsx)("td",{className:"jsx-ea7e30f1006202ef py-3 px-4 text-right text-gray-900",children:e.quantity}),(0,t.jsx)("td",{className:"jsx-ea7e30f1006202ef py-3 px-4 text-right text-gray-900",children:(0,d.L)(e.price)}),(0,t.jsx)("td",{className:"jsx-ea7e30f1006202ef py-3 px-4 text-right font-semibold text-gray-900",children:(0,d.L)(Number(e.price)*e.quantity)})]},e.id)})})]})}),(0,t.jsx)("div",{className:"jsx-ea7e30f1006202ef flex justify-end mb-8",children:(0,t.jsx)("div",{className:"jsx-ea7e30f1006202ef w-80",children:(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef space-y-2",children:[(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef flex justify-between text-gray-600",children:[(0,t.jsx)("span",{className:"jsx-ea7e30f1006202ef",children:"Subtotal:"}),(0,t.jsx)("span",{className:"jsx-ea7e30f1006202ef font-semibold",children:(0,d.L)(h.subtotal||0)})]}),h.shipping>0&&(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef flex justify-between text-gray-600",children:[(0,t.jsx)("span",{className:"jsx-ea7e30f1006202ef",children:"Shipping:"}),(0,t.jsx)("span",{className:"jsx-ea7e30f1006202ef font-semibold",children:(0,d.L)(h.shipping||0)})]}),h.tax>0&&(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef flex justify-between text-gray-600",children:[(0,t.jsx)("span",{className:"jsx-ea7e30f1006202ef",children:"Tax:"}),(0,t.jsx)("span",{className:"jsx-ea7e30f1006202ef font-semibold",children:(0,d.L)(h.tax||0)})]}),h.discount>0&&(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef flex justify-between text-red-600",children:[(0,t.jsx)("span",{className:"jsx-ea7e30f1006202ef",children:"Discount:"}),(0,t.jsxs)("span",{className:"jsx-ea7e30f1006202ef font-semibold",children:["-",(0,d.L)(h.discount)]})]}),(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef flex justify-between text-lg font-black text-gray-900 pt-2 border-t-2 border-gray-900",children:[(0,t.jsx)("span",{className:"jsx-ea7e30f1006202ef",children:"Total:"}),(0,t.jsx)("span",{className:"jsx-ea7e30f1006202ef",children:(0,d.L)(h.total||0)})]})]})})}),(0,t.jsxs)("div",{className:"jsx-ea7e30f1006202ef border-t-2 border-gray-300 pt-6 text-center text-sm text-gray-600",children:[(0,t.jsx)("p",{className:"jsx-ea7e30f1006202ef font-semibold mb-2",children:"Thank you for your business!"}),(0,t.jsx)("p",{className:"jsx-ea7e30f1006202ef",children:"For questions about this invoice, please contact support@dilitechsolutions.com"}),(0,t.jsxs)("p",{className:"jsx-ea7e30f1006202ef mt-2",children:["This is an automated invoice generated on ",new Date().toLocaleDateString()]})]})]}),(0,t.jsx)(r(),{id:"ea7e30f1006202ef",children:"@media print{body{background:white}.no-print{display:none}}"})]}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-white p-4",children:(0,t.jsxs)("div",{className:"max-w-md text-center",children:[(0,t.jsx)("p",{className:"text-xl font-bold text-gray-900 mb-2",children:g||"Invoice not available"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Please check the order and try again."})]})})}},7908:(e,s,a)=>{"use strict";a.d(s,{A:()=>r,k:()=>i});var t=a(5155);let i=(0,a(2115).memo)(function(e){let{size:s="md",color:a="sky",text:i="Loading...",className:r=""}=e,l={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"},n={sky:"border-brand-sky",indigo:"border-brand-indigo",slate:"border-slate-600",white:"border-white"};return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center ".concat(r),role:"status","aria-live":"polite",children:[(0,t.jsx)("div",{className:"\n          ".concat(l[s]||l.md," \n          ").concat(n[a]||n.sky," \n          border-2 border-t-transparent rounded-full animate-spin\n        ")}),i&&(0,t.jsx)("p",{className:"mt-2 text-sm text-slate-400 animate-pulse",children:i})]})}),r=i},9663:(e,s,a)=>{"use strict";a.d(s,{L:()=>t});let t=e=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(Number(e)||0)}},e=>{var s=s=>e(e.s=s);e.O(0,[3830,1097,2432,7979,4884,7098,9744,2033,2322,9592,7331,2652,5030,8392,7694,9173,9401,7358],()=>s(7921)),_N_E=e.O()}]);