"use strict";(()=>{var e={};e.id=8887,e.ids=[8887],e.modules={96330:e=>{e.exports=require("@prisma/client")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55511:e=>{e.exports=require("crypto")},62907:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>j,routeModule:()=>x,serverHooks:()=>v,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>y});var a={};t.r(a),t.d(a,{POST:()=>h});var s=t(42706),i=t(28203),n=t(45994),o=t(34926),u=t(84574),p=t(35743),l=t(65287),d=t(74559),c=t(71018),m=t(51978);let w=m.Ikc({email:m.YjP().email("Invalid email format"),password:m.YjP().min(6,"Password must be at least 6 characters long"),name:m.YjP().optional(),firstName:m.YjP().optional(),lastName:m.YjP().optional()}),h=(0,p.Rq)({rateLimiter:l.t5,validator:(0,d.S)(w),handler:async e=>{let{email:r,password:t,name:a,firstName:s,lastName:i}=e.validatedData,n=r.toLowerCase().trim(),l=Date.now(),d=await u.zR.user.findUnique({where:{email:n}}),m=Date.now()-l;if(c.Ay.dbQuery("user.findUnique",m,{email:n}),d)return c.Ay.warn("Signup attempt with existing email",{email:n}),p.sh.error("An account with this email already exists",409);let w=await o.Ay.hash(t,12),h=a||(s&&i?`${s} ${i}`.trim():s||i||null),x=Date.now(),g=await u.zR.user.create({data:{email:n,password:w,name:h,role:"USER"}}),y=Date.now()-x;return c.Ay.dbQuery("user.create",y),c.Ay.info("User account created",{userId:g.id,email:n}),p.sh.success({id:g.id,email:g.email,name:g.name,role:g.role},"Account created successfully",201)}}),x=new s.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/auth/signup/route",pathname:"/api/auth/signup",filename:"route",bundlePath:"app/api/auth/signup/route"},resolvedPagePath:"/Users/user/Desktop/RogueApe/work/jabistore/src/app/api/auth/signup/route.js",nextConfigOutput:"",userland:a}),{workAsyncStorage:g,workUnitAsyncStorage:y,serverHooks:v}=x;function j(){return(0,n.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:y})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[5994,5452,4926,1978,472],()=>t(62907));module.exports=a})();